<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pasapalabra Mecanismos</title>
    
    <!-- PWA Settings -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öôÔ∏è</text></svg>">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        body {
            font-family: 'Rubik', sans-serif;
            background-color: #0f172a; 
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            touch-action: manipulation;
        }
        
        .rosco-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .rosco-container {
            position: relative;
            width: 90%; 
            aspect-ratio: 1 / 1; 
            max-width: 550px;
            max-height: 550px;
        }

        .letter-item {
            position: absolute;
            width: 11%; 
            height: 11%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.4rem;
            border: 3px solid white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .status-pending { background: linear-gradient(145deg, #3b82f6, #1d4ed8); color: white; }
        .status-current { background: linear-gradient(145deg, #f59e0b, #d97706); transform: scale(1.3); z-index: 20; border-color: #fffbeb; box-shadow: 0 0 25px rgba(245, 158, 11, 0.6); }
        .status-correct { background: linear-gradient(145deg, #22c55e, #15803d); border-color: #86efac; }
        .status-wrong { background: linear-gradient(145deg, #ef4444, #b91c1c); border-color: #fca5a5; }
        .status-skipped { background: linear-gradient(145deg, #64748b, #475569); opacity: 0.6; transform: scale(0.9); }

        .definition-text {
            font-size: 1.8rem;
            line-height: 1.4;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .left-panel-content {
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #334155 #0f172a;
        }

        @media (max-width: 1024px) {
            .rosco-container { max-width: 400px; max-height: 400px; }
            .letter-item { font-size: 1rem; }
            .definition-text { font-size: 1.3rem; }
        }

        @media (max-width: 768px) {
            body { height: 100vh; overflow: auto; }
            .rosco-container { width: 85vw; margin: 1rem 0; max-height: 40vh; }
            .letter-item { font-size: 0.9rem; width: 10%; height: 10%; }
        }

        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fade-in 0.3s ease-out forwards; }
    </style>
</head>
<body>
    <div id="root" class="h-full"></div>

    <script type="text/babel">
        const QUESTION_BANK = {
            A: [{ q: "Barra cil√≠ndrica que transmite un movimiento de giro y soporta piezas como poleas o engranajes.", a: "√Årbol", contains: false }],
            B: [{ q: "Barra r√≠gida que une la manivela con el √©mbolo para transformar el movimiento circular en lineal.", a: "Biela", contains: false }],
            C: [{ q: "Barra dentada que, junto a un pi√±√≥n, convierte el movimiento circular en lineal rectil√≠neo.", a: "Cremallera", contains: false }],
            D: [{ q: "Cada uno de los elementos de un engranaje que transmiten el esfuerzo de empuje al encajar.", a: "Diente", contains: false }],
            E: [{ q: "Rueda dentada que transmite movimiento por contacto directo con otra rueda.", a: "Engranaje", contains: false }],
            F: [{ q: "Punto de apoyo de una palanca.", a: "Fulcro", contains: false }],
            G: [{ q: "Cada una de las tres clases de palancas seg√∫n la posici√≥n de sus componentes.", a: "Grado", contains: false }],
            H: [{ q: "Tipo de engranaje cuyos dientes est√°n tallados de forma inclinada o en h√©lice.", a: "Helicoidal", contains: false }],
            I: [{ q: "Relaci√≥n entre las velocidades de giro de la rueda conducida y la rueda motriz.", a: "Transmisi√≥n", contains: true }],
            J: [{ q: "Barra sobre la que gira una rueda pero que no transmite potencia (a diferencia del √°rbol).", a: "Eje", contains: true }],
            L: [{ q: "Pieza de contorno irregular que transmite movimiento alternativo a un seguidor.", a: "Leva", contains: false }],
            M: [{ q: "Barra doblada en √°ngulo unida a un eje que se hace girar para transmitir movimiento.", a: "Manivela", contains: false }],
            N: [{ q: "Unidad de medida de la fuerza en el Sistema Internacional.", a: "Newton", contains: false }],
            √ë: [{ q: "Rueda dentada m√°s peque√±a de un sistema de engranajes o de cadena.", a: "Pi√±√≥n", contains: true }],
            O: [{ q: "Movimiento de vaiv√©n circular, como el de un p√©ndulo.", a: "Oscilante", contains: false }],
            P: [{ q: "Fuerza aplicada en una palanca para vencer una carga o resistencia.", a: "Potencia", contains: false }],
            Q: [{ q: "Conjunto de mecanismos combinados para recibir energ√≠a y realizar un trabajo.", a: "M√°quina", contains: true }],
            R: [{ q: "Fuerza o peso que se opone al movimiento y que queremos vencer.", a: "Resistencia", contains: false }],
            S: [{ q: "Varilla que se apoya sobre una leva y recibe su movimiento variable.", a: "Seguidor", contains: false }],
            T: [{ q: "Mecanismo formado por un cilindro roscado y una rueda dentada.", a: "Tornillo sin fin", contains: false }],
            U: [{ q: "Pieza con rosca interior que se desplaza a lo largo de un eje roscado.", a: "Tuerca", contains: true }],
            V: [{ q: "Magnitud que indica la rapidez del movimiento.", a: "Velocidad", contains: false }],
            W: [{ q: "Apellido del ingeniero que da nombre a la unidad de potencia del S.I. (vatio).", a: "Watt", contains: true }],
            X: [{ q: "Situaci√≥n de dos ruedas o ejes que comparten el mismo centro de giro.", a: "Coaxial", contains: true }],
            Y: [{ q: "Principio que dice que Potencia por su brazo es igual a Resistencia por el suyo.", a: "Ley de la palanca", contains: true }],
            Z: [{ q: "Pieza que fricciona contra una rueda para disminuir o detener su movimiento.", a: "Zapata", contains: false }]
        };

        const ALPHABET = "ABCDEFGHILMN√ëOPQRSTUVWXYZ".split("").filter(l => QUESTION_BANK[l]);

        const Timer = ({ duration, onTimeUp, isActive, resetTrigger }) => {
            const [timeLeft, setTimeLeft] = React.useState(duration);

            React.useEffect(() => { setTimeLeft(duration); }, [resetTrigger, duration]);

            React.useEffect(() => {
                if (!isActive || timeLeft <= 0) return;
                const timerId = setInterval(() => { setTimeLeft(prev => prev - 1); }, 1000);
                return () => clearInterval(timerId);
            }, [isActive, timeLeft]);

            React.useEffect(() => { if (timeLeft === 0 && isActive) onTimeUp(); }, [timeLeft, isActive, onTimeUp]);

            return (
                <div className="w-full mt-4 bg-slate-800 p-4 rounded-xl shadow-lg border border-slate-700">
                    <div className="flex justify-between items-center mb-4">
                        <span className="text-slate-300 text-sm md:text-lg font-bold uppercase tracking-wider">Tiempo Restante</span>
                        {/* SEPARACI√ìN AUMENTADA: ml-24 para m√°ximo espacio */}
                        <span className={`text-4xl md:text-5xl font-black font-mono leading-none ml-24 ${timeLeft <= 5 ? 'text-red-500 animate-pulse' : 'text-white'}`}>
                            {timeLeft}<span className="text-lg text-slate-500 ml-1">s</span>
                        </span>
                    </div>
                    <div className="w-full bg-slate-900 h-4 rounded-full overflow-hidden border border-slate-700">
                        <div 
                            className={`h-full transition-all duration-1000 ease-linear ${timeLeft > duration * 0.5 ? 'bg-green-500' : timeLeft > duration * 0.2 ? 'bg-yellow-500' : 'bg-red-600 animate-pulse'}`}
                            style={{ width: `${(timeLeft / duration) * 100}%` }}
                        ></div>
                    </div>
                </div>
            );
        };

        const Rosco = ({ letters, currentIndex, definitions }) => {
            const radius = 42; 
            const angleStep = (2 * Math.PI) / letters.length;

            return (
                <div className="rosco-container">
                    {letters.map((letter, index) => {
                        const angle = index * angleStep - Math.PI / 2;
                        const x = 50 + radius * Math.cos(angle);
                        const y = 50 + radius * Math.sin(angle);
                        
                        let statusClass = "status-pending";
                        const letterData = definitions.find(d => d.char === letter);
                        
                        if (index === currentIndex) statusClass = "status-current";
                        else if (letterData?.status === 'correct') statusClass = "status-correct";
                        else if (letterData?.status === 'wrong') statusClass = "status-wrong";
                        else if (letterData?.status === 'skipped') statusClass = "status-skipped";

                        return (
                            <div key={letter} className={`letter-item ${statusClass}`} style={{ left: `calc(${x}% - 5.5%)`, top: `calc(${y}% - 5.5%)` }}>
                                {letter}
                            </div>
                        );
                    })}
                </div>
            );
        };

        const Game = () => {
            const [gameState, setGameState] = React.useState('setup'); 
            const [definitions, setDefinitions] = React.useState([]);
            const [currentIndex, setCurrentIndex] = React.useState(0);
            const [timePerTurn, setTimePerTurn] = React.useState(25);
            const [showAnswer, setShowAnswer] = React.useState(false);
            const [score, setScore] = React.useState({ correct: 0, wrong: 0 });

            const startGame = () => {
                const newDefinitions = ALPHABET.map(char => {
                    const data = QUESTION_BANK[char][0];
                    return { char, status: 'pending', question: data.q, answer: data.a, contains: data.contains };
                });
                setDefinitions(newDefinitions);
                setCurrentIndex(0);
                setScore({ correct: 0, wrong: 0 });
                setGameState('playing');
                setShowAnswer(false);
            };

            const moveToNext = () => {
                let nextIndex = currentIndex + 1;
                let loops = 0;
                while (loops < 2) { 
                    if (nextIndex >= definitions.length) { nextIndex = 0; loops++; }
                    if (definitions[nextIndex].status === 'pending' || definitions[nextIndex].status === 'skipped') {
                        setCurrentIndex(nextIndex);
                        setShowAnswer(false);
                        return;
                    }
                    nextIndex++;
                }
                setGameState('finished');
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            };

            const handleAnswer = (isCorrect) => {
                const newDefs = [...definitions];
                newDefs[currentIndex].status = isCorrect ? 'correct' : 'wrong';
                setDefinitions(newDefs);
                setScore(prev => ({ correct: prev.correct + (isCorrect ? 1 : 0), wrong: prev.wrong + (isCorrect ? 0 : 1) }));
                setTimeout(moveToNext, 500);
            };

            if (gameState === 'setup') {
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen p-4 bg-slate-900 text-center overflow-auto">
                        <div className="max-w-4xl w-full grid md:grid-cols-2 gap-12 items-center">
                            <div className="text-left">
                                <h1 className="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-500 mb-8 tracking-tighter uppercase">Mecanismos</h1>
                                <p className="text-slate-400 text-lg uppercase tracking-widest font-bold">Tecnolog√≠a y Digitalizaci√≥n</p>
                            </div>
                            <div className="bg-slate-800 p-8 rounded-3xl border border-slate-700 shadow-2xl">
                                <label className="block text-slate-400 mb-3 text-lg font-medium">Segundos por turno:</label>
                                <div className="flex items-center justify-center gap-4 mb-8">
                                    <button onClick={() => setTimePerTurn(Math.max(5, timePerTurn - 5))} className="w-12 h-12 bg-slate-700 rounded-full text-xl">-</button>
                                    <span className="text-4xl font-bold font-mono w-20">{timePerTurn}</span>
                                    <button onClick={() => setTimePerTurn(timePerTurn + 5)} className="w-12 h-12 bg-slate-700 rounded-full text-xl">+</button>
                                </div>
                                <button onClick={startGame} className="w-full py-5 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl text-2xl font-bold hover:scale-105 transition-transform">¬°EMPEZAR!</button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (gameState === 'finished') {
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen text-center p-4 bg-slate-900">
                        <h1 className="text-6xl font-black text-white mb-12 uppercase tracking-tighter">¬°Resultados!</h1>
                        <div className="flex gap-12 mb-16 flex-wrap justify-center">
                            <div className="bg-slate-800 p-8 rounded-3xl w-64 border-b-8 border-green-500 shadow-2xl">
                                <div className="text-8xl font-black text-green-500">{score.correct}</div>
                                <div className="text-xl uppercase tracking-widest text-slate-400 font-bold mt-2">Aciertos</div>
                            </div>
                            <div className="bg-slate-800 p-8 rounded-3xl w-64 border-b-8 border-red-500 shadow-2xl">
                                <div className="text-8xl font-black text-red-500">{score.wrong}</div>
                                <div className="text-xl uppercase tracking-widest text-slate-400 font-bold mt-2">Fallos</div>
                            </div>
                        </div>
                        <button onClick={() => setGameState('setup')} className="px-10 py-4 bg-white text-slate-900 rounded-full text-xl font-black hover:bg-gray-200">REINTENTAR</button>
                    </div>
                );
            }

            const current = definitions[currentIndex];

            return (
                <div className="flex flex-col md:flex-row h-full w-full bg-slate-900 overflow-hidden">
                    <div className="w-full md:w-3/5 p-4 md:p-12 flex flex-col justify-center bg-slate-900 md:border-r border-slate-800 left-panel-content relative z-20">
                        <div className="flex gap-4 mb-8">
                            <div className="bg-slate-800 px-6 py-2 rounded-full border border-slate-700 font-mono font-bold text-green-500 shadow-lg">‚úì {score.correct}</div>
                            <div className="bg-slate-800 px-6 py-2 rounded-full border border-slate-700 font-mono font-bold text-red-500 shadow-lg">‚úï {score.wrong}</div>
                        </div>

                        <div className="mb-6">
                            <div className={`inline-flex items-center px-6 py-3 rounded-2xl text-2xl font-black uppercase tracking-wider border-4 shadow-xl ${current.contains ? 'bg-amber-900/40 text-amber-400 border-amber-500' : 'bg-blue-900/40 text-blue-400 border-blue-500'}`}>
                                <span className="text-5xl mr-4">{current.char}</span>
                                <span>{current.contains ? 'CONTIENE' : 'EMPIEZA'}</span>
                            </div>
                        </div>

                        <div className="definition-text text-white mb-8 min-h-[140px] flex items-center">{current.question}</div>
                        
                        <div className="h-16 mb-8 flex items-center">
                            {showAnswer ? (
                                <div className="text-yellow-400 font-black text-4xl animate-fade-in bg-yellow-900/20 px-6 py-3 rounded-xl border border-yellow-500/30">üëâ {current.answer}</div>
                            ) : (
                                <button onClick={() => setShowAnswer(true)} className="text-slate-500 hover:text-slate-300 text-sm font-bold uppercase tracking-widest transition-colors flex items-center gap-2"><span>üëÅÔ∏è</span> Mostrar respuesta</button>
                            )}
                        </div>

                        <div className="grid grid-cols-3 gap-4 mb-8">
                            <button onClick={() => handleAnswer(false)} className="py-5 bg-red-600/10 border-2 border-red-600 text-red-500 rounded-2xl hover:bg-red-600 hover:text-white text-xl font-bold transition-all shadow-lg active:scale-95">FALLO</button>
                            <button onClick={() => { definitions[currentIndex].status = 'skipped'; moveToNext(); }} className="py-5 bg-slate-800 border-2 border-slate-600 text-slate-300 rounded-2xl hover:bg-slate-700 hover:text-white text-lg font-bold transition-all active:scale-95 shadow-lg">PASO</button>
                            <button onClick={() => handleAnswer(true)} className="py-5 bg-green-600/10 border-2 border-green-600 text-green-500 rounded-2xl hover:bg-green-600 hover:text-white text-xl font-bold transition-all shadow-lg active:scale-95">ACIERTO</button>
                        </div>

                        <Timer duration={timePerTurn} onTimeUp={() => setShowAnswer(true)} isActive={gameState === 'playing' && !showAnswer} resetTrigger={currentIndex} />
                    </div>

                    <div className="w-full md:w-2/5 bg-slate-950 flex items-center justify-center p-4 relative h-[45vh] md:h-full order-first md:order-last border-b-4 md:border-b-0 md:border-l-4 border-slate-800">
                        <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-blue-900/10 via-slate-950 to-slate-950"></div>
                        <div className="rosco-wrapper z-10">
                            {/* ELIMINADO BLOQUE DE LOGOTIPO CENTRAL COMPLETAMENTE */}
                            <Rosco letters={ALPHABET} currentIndex={currentIndex} definitions={definitions} />
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Game />);
    </script>
</body>
</html>